{"ast":null,"code":"import _objectSpread from\"/Users/mac/Desktop/data/application/EFrontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState,useRef}from'react';import Header from'./Home/Header';import Footer2 from'./Home/Footer2';import{useApi}from'./hooks/useApi';import{API_BASE,API_BASE_URL}from'./config';import{useTranslation}from'react-i18next';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const COURSE={title:\"Net Zero Carbon Strategy for Business\",description:\"A comprehensive course on decarbonisation, carbon accounting, carbon reduction, and sustainability for businesses. Taught by industry experts. Includes video lectures, downloadable resources, and a certificate.\",price:10,image:require('./Home/Logo.png'),id:'netzero-carbon-course'};const BuyCourses=()=>{const{t,i18n}=useTranslation();const[date,setDate]=useState('');const[people,setPeople]=useState(8);const[checking,setChecking]=useState(false);const[available,setAvailable]=useState(null);const[error,setError]=useState('');const[stripeLoading,setStripeLoading]=useState(false);const[city,setCity]=useState('');const[instructors,setInstructors]=useState([]);const[selectedInstructor,setSelectedInstructor]=useState('');const[availableSlots,setAvailableSlots]=useState([]);const[selectedSlot,setSelectedSlot]=useState(null);const[message,setMessage]=useState('');const userPackage=(localStorage.getItem('package')||'').toLowerCase();const isEligible=userPackage==='pro'||userPackage==='premium';const hasCourse=localStorage.getItem('hasCourse')==='true';const[preferredStart,setPreferredStart]=useState('');const[preferredEnd,setPreferredEnd]=useState('');const[courses,setCourses]=useState([]);const[selectedCourse,setSelectedCourse]=useState(null);const{get,post}=useApi();const[area,setArea]=useState('');const[bookingId,setBookingId]=useState(null);const[bookingStatus,setBookingStatus]=useState('');const pollingRef=useRef(null);const[autofilled,setAutofilled]=useState(false);const[confirmedBooking,setConfirmedBooking]=useState(null);useEffect(()=>{// Optionally, fetch from backend if you want to check real purchase status\n},[]);// Fetch all courses on mount\nuseEffect(()=>{fetch(\"\".concat(API_BASE_URL,\"/api/courses\")).then(res=>res.json()).then(data=>{// Ensure distinct courses by normalizing names\nconst courseMap={};data.forEach(course=>{const normalizedName=course.name.trim().toLowerCase();const key=normalizedName+'|'+course.durationWeeks;if(!courseMap[key]){courseMap[key]={name:course.name.trim(),durationWeeks:course.durationWeeks};}});setCourses(Object.values(courseMap));});},[]);// Fetch instructors when city or area changes\nuseEffect(()=>{if(city){fetch(\"\".concat(API_BASE_URL,\"/api/instructors?city=\").concat(encodeURIComponent(city))).then(res=>res.json()).then(data=>{// First, filter by city and area\nconst areaMatches=data.filter(inst=>{var _inst$city,_inst$location;return((_inst$city=inst.city)===null||_inst$city===void 0?void 0:_inst$city.toLowerCase())===city.toLowerCase()&&((_inst$location=inst.location)===null||_inst$location===void 0?void 0:_inst$location.toLowerCase())===area.toLowerCase();});// If no area matches, show all city matches\nconst cityMatches=data.filter(inst=>{var _inst$city2;return((_inst$city2=inst.city)===null||_inst$city2===void 0?void 0:_inst$city2.toLowerCase())===city.toLowerCase();});const filtered=area&&areaMatches.length>0?areaMatches:cityMatches;setInstructors(filtered);// Aggregate unique courses from these instructors\nconst courseMap={};filtered.forEach(inst=>{(inst.subjects||[]).forEach(subj=>{// Normalize course name to handle case variations\nconst normalizedName=subj.name.trim().toLowerCase();const key=normalizedName+'|'+subj.durationWeeks;if(!courseMap[key]){courseMap[key]={name:subj.name.trim(),// Keep original case for display\ndurationWeeks:subj.durationWeeks};}});});setCourses(Object.values(courseMap));}).catch(()=>{setInstructors([]);setCourses([]);});}else{setInstructors([]);setCourses([]);}setSelectedInstructor('');setAvailableSlots([]);setSelectedSlot(null);setSelectedCourse(null);},[city,area,date]);// Helper to subtract a booking from a slot\nfunction subtractBooking(slot,booking){// No overlap\nif(booking.end<=slot.start||booking.start>=slot.end)return[slot];// Booking covers the whole slot\nif(booking.start<=slot.start&&booking.end>=slot.end)return[];// Booking overlaps at the start\nif(booking.start<=slot.start&&booking.end<slot.end)return[{start:booking.end,end:slot.end}];// Booking overlaps at the end\nif(booking.start>slot.start&&booking.end>=slot.end)return[{start:slot.start,end:booking.start}];// Booking is in the middle\nreturn[{start:slot.start,end:booking.start},{start:booking.end,end:slot.end}];}// Helper to convert time to 24-hour format\nfunction to24Hour(timeStr){if(!timeStr)return'';if(timeStr.includes(':')&&(timeStr.includes('AM')||timeStr.includes('PM'))){// e.g., '10:14 AM' or '01:09 PM'\nconst[time,modifier]=timeStr.split(' ');let[hours,minutes]=time.split(':');if(modifier==='PM'&&hours!=='12')hours=String(Number(hours)+12);if(modifier==='AM'&&hours==='12')hours='00';return\"\".concat(hours.padStart(2,'0'),\":\").concat(minutes);}// Already in 24-hour format\nreturn timeStr;}// Fetch available slots for all instructors in city for selected date and preferred time\nuseEffect(()=>{if(instructors.length&&date&&preferredStart&&preferredEnd&&selectedCourse){Promise.all(instructors.map(inst=>fetch(\"\".concat(API_BASE_URL,\"/api/instructors/profile/\").concat(inst.email)).then(res=>res.json()))).then(profiles=>{// Filter instructors who offer the selected course\nconst filteredProfiles=profiles.filter(inst=>(inst.subjects||[]).some(subj=>subj.name.toLowerCase().trim()===selectedCourse.name.toLowerCase().trim()&&String(subj.durationWeeks)===String(selectedCourse.durationWeeks)));const day=new Date(date).toLocaleDateString('en-US',{weekday:'long'});let slots=[];filteredProfiles.forEach(inst=>{var _inst$availability;const avail=((_inst$availability=inst.availability)===null||_inst$availability===void 0?void 0:_inst$availability[day])||[];const bookings=(inst.bookings||[]).filter(b=>b.date===date);avail.forEach(slot=>{let free=[_objectSpread({},slot)];bookings.forEach(bk=>{free=free.flatMap(s=>subtractBooking(s,bk));});free.forEach(f=>{// Only show slots that overlap with preferred time\nif(f.start&&f.end&&f.start<=preferredEnd&&f.end>=preferredStart){// Clamp slot to preferred time\nconst slotStart=f.start<preferredStart?preferredStart:f.start;const slotEnd=f.end>preferredEnd?preferredEnd:f.end;slots.push({instructor:inst.email,start:slotStart,end:slotEnd,name:\"\".concat(inst.firstName,\" \").concat(inst.lastName),location:inst.location});}});});});setAvailableSlots(slots);});}else{setAvailableSlots([]);}},[instructors,date,preferredStart,preferredEnd,selectedCourse]);const checkAvailability=async()=>{setChecking(true);setError('');setTimeout(()=>{setAvailable(true);setChecking(false);},700);};const handleBook=async()=>{if(!selectedCourse||!date||!city||!area){setError('Please fill all fields.');return;}setStripeLoading(true);setError('');setMessage('');try{const userId=localStorage.getItem('userId');if(!userId){setError('You must be logged in to book.');setStripeLoading(false);return;}// Convert times to 24-hour format\nconst start24=to24Hour(preferredStart);const end24=to24Hour(preferredEnd);const response=await fetch(\"\".concat(API_BASE_URL,\"/api/bookings\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId,date,city,area,courseName:selectedCourse.name,durationWeeks:selectedCourse.durationWeeks,start:start24,end:end24})});const data=await response.json();if(response.status===201){setMessage('Booking created and instructors notified. Awaiting instructor confirmation.');setBookingId(data.bookingId);setBookingStatus('on-hold');// Start polling for status\nif(pollingRef.current)clearInterval(pollingRef.current);pollingRef.current=setInterval(async()=>{const statusRes=await fetch(\"\".concat(API_BASE_URL,\"/api/bookings/\").concat(data.bookingId,\"/status\"));const statusData=await statusRes.json();if(statusData.status==='confirmed'){setBookingStatus('confirmed');setMessage('Booking confirmed! You can now proceed to payment.');clearInterval(pollingRef.current);}},5000);}else{setError(data.message||'Booking failed. Please try another date.');}}catch(err){setError('Booking error.');}setStripeLoading(false);};const handleCheckout=async()=>{setStripeLoading(true);setError('');let price=COURSE.price*people;if(userPackage==='premium')price=price*0.8;try{const res=await fetch(\"\".concat(API_BASE,\"/api/create-checkout-session\"),{method:'POST',headers:{'Content-Type':'application/json'},credentials:'include',body:JSON.stringify({cart:[{name:COURSE.title,price,quantity:1}]})});const data=await res.json();if(data.url){localStorage.setItem('purchasedPackage',\"course:\".concat(COURSE.title));localStorage.setItem('hasCourse','true');if(bookingId){localStorage.setItem('bookingId',bookingId);}window.location.href=data.url;}else{setError('Failed to start checkout.');}}catch(err){setError('Checkout error.');}finally{setStripeLoading(false);}};// Autofill form after booking is confirmed\nuseEffect(()=>{if(bookingId&&bookingStatus==='confirmed'&&!autofilled){fetch(\"\".concat(API_BASE_URL,\"/api/bookings/\").concat(bookingId,\"/status\")).then(res=>res.json()).then(data=>{if(data&&data.status==='confirmed'){// Assume booking details are available in data or fetch full booking if needed\nfetch(\"\".concat(API_BASE_URL,\"/api/bookings/user/\").concat(localStorage.getItem('userId'))).then(res=>res.json()).then(bookings=>{const booking=bookings.find(b=>b._id===bookingId);if(booking){setDate(booking.date);setCity(booking.city);setArea(booking.area);setSelectedCourse({name:booking.courseName,durationWeeks:booking.durationWeeks});setAutofilled(true);}});}});}},[bookingId,bookingStatus,autofilled]);// On page load, check for pending payment booking\nuseEffect(()=>{const userId=localStorage.getItem('userId');if(!userId)return;fetch(\"\".concat(API_BASE_URL,\"/api/bookings/user/\").concat(userId)).then(res=>res.json()).then(bookings=>{// Find the latest booking that is confirmed but not paid\nconst pending=bookings.find(b=>b.status==='confirmed'&&!b.paid);if(pending){setBookingId(pending._id);setDate(pending.date);setCity(pending.city);setArea(pending.area);setSelectedCourse({name:pending.courseName,durationWeeks:pending.durationWeeks});setBookingStatus('confirmed');setAutofilled(true);}else{// No pending payment, reset autofill\nsetBookingId(null);setDate('');setCity('');setArea('');setSelectedCourse(null);setBookingStatus('');setAutofilled(false);}});},[]);// After payment, clear autofill and allow new bookings\nuseEffect(()=>{if(autofilled&&bookingStatus==='confirmed'&&hasCourse){setBookingId(null);setDate('');setCity('');setArea('');setSelectedCourse(null);setBookingStatus('');setAutofilled(false);}},[hasCourse]);// Show booking confirmation after payment\nuseEffect(()=>{const bookingIdLS=localStorage.getItem('bookingId');if(hasCourse&&bookingIdLS){fetch(\"\".concat(API_BASE_URL,\"/api/bookings/\").concat(bookingIdLS,\"/status\")).then(res=>res.json()).then(data=>{setConfirmedBooking(data);localStorage.removeItem('bookingId');});}},[hasCourse]);// Always reset confirmation on mount so form is shown on new visits\nuseEffect(()=>{setConfirmedBooking(null);},[]);// Reset form after payment is successful (booking is paid)\nuseEffect(()=>{if(bookingStatus==='confirmed'&&confirmedBooking&&confirmedBooking.paid){setDate('');setCity('');setArea('');setSelectedCourse(null);setPeople(8);setPreferredStart('');setPreferredEnd('');setAvailableSlots([]);setSelectedSlot(null);setMessage('');setError('');setBookingId(null);setBookingStatus('');setAutofilled(false);setConfirmedBooking(null);}},[bookingStatus,confirmedBooking]);useEffect(()=>{const savedLang=localStorage.getItem('selectedLanguage');if(savedLang&&savedLang!==i18n.language){i18n.changeLanguage(savedLang);}},[i18n]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(\"div\",{style:{margin:'200px',background:'#fff',minHeight:'100vh',padding:'120px 0 60px 0',display:'flex',flexDirection:'column',alignItems:'center'},children:/*#__PURE__*/_jsxs(\"div\",{style:{width:400,background:'#fff',borderRadius:20,boxShadow:'0 4px 24px rgba(0,0,0,0.08)',overflow:'hidden',margin:'32px 0',padding:0},children:[/*#__PURE__*/_jsxs(\"div\",{style:{height:180,background:'#222',display:'flex',alignItems:'center',justifyContent:'center',overflow:'hidden',position:'relative'},children:[/*#__PURE__*/_jsx(\"img\",{src:COURSE.image,alt:t('buycourses.course_image_alt'),style:{width:'100%',height:'100%',objectFit:'cover'}}),/*#__PURE__*/_jsx(\"span\",{style:{position:'absolute',top:16,left:16,background:'#ffb400',color:'#fff',borderRadius:8,padding:'4px 16px',fontWeight:600,fontSize:16,boxShadow:'0 2px 8px rgba(0,0,0,0.08)',display:'inline-block'},children:t('buycourses.featured')})]}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:28},children:[/*#__PURE__*/_jsx(\"h2\",{style:{fontWeight:700,fontSize:24,marginBottom:8},children:t('buycourses.title')}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#222',fontSize:16,marginBottom:12},children:t('buycourses.description')}),/*#__PURE__*/_jsxs(\"div\",{style:{color:'#27ae60',fontWeight:600,fontSize:18,marginBottom:8},children:[t('buycourses.price',{price:COURSE.price}),\" \",userPackage==='premium'&&/*#__PURE__*/_jsxs(\"span\",{children:[\"(\",t('buycourses.premium_discount'),\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#888',fontSize:14,marginBottom:18},children:t('buycourses.min_people')}),confirmedBooking?/*#__PURE__*/_jsxs(\"div\",{style:{color:'green',fontWeight:600,fontSize:18,margin:'18px 0'},children:[/*#__PURE__*/_jsx(\"h2\",{children:t('buycourses.booking_confirmed')}),confirmedBooking.instructor&&/*#__PURE__*/_jsxs(\"p\",{children:[t('buycourses.instructor'),\": \",confirmedBooking.instructor.firstName,\" \",confirmedBooking.instructor.lastName,\" (\",confirmedBooking.instructor.email,\")\"]}),/*#__PURE__*/_jsx(\"p\",{children:t('buycourses.payment_thank_you')}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setConfirmedBooking(null);setDate('');setCity('');setArea('');setSelectedCourse(null);setPeople(8);setPreferredStart('');setPreferredEnd('');setAvailableSlots([]);setSelectedSlot(null);setMessage('');setError('');setBookingId(null);setBookingStatus('');setAutofilled(false);},style:{marginTop:16,background:'#90be55',color:'#fff',border:'none',borderRadius:6,padding:'10px 24px',fontWeight:600,fontSize:16},children:t('buycourses.book_another')})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[!isEligible&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#e74c3c',fontWeight:600,fontSize:18,margin:'18px 0'},children:[t('buycourses.membership_required'),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"a\",{href:\"/pricing\",style:{color:'#ff6b57',textDecoration:'underline'},children:t('buycourses.see_membership')})]}),/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"ol\",{style:{marginBottom:16,color:'#888',fontSize:15,paddingLeft:18},children:[/*#__PURE__*/_jsx(\"li\",{children:t('buycourses.step1')}),/*#__PURE__*/_jsx(\"li\",{children:t('buycourses.step2')}),/*#__PURE__*/_jsx(\"li\",{children:t('buycourses.step3')}),/*#__PURE__*/_jsx(\"li\",{children:t('buycourses.step4')})]}),/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:8},children:t('buycourses.people_label')}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:8,value:people,onChange:e=>setPeople(Math.max(8,parseInt(e.target.value)||8)),style:{width:'100%',marginBottom:12,padding:8,borderRadius:6,border:'1px solid #ccc'},disabled:bookingStatus==='confirmed'&&autofilled}),/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:8},children:t('buycourses.city_label')}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:city,onChange:e=>setCity(e.target.value),style:{width:'100%',marginBottom:12,padding:8,borderRadius:6,border:'1px solid #ccc'},disabled:bookingStatus==='confirmed'&&autofilled}),/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:8},children:t('buycourses.area_label')}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:area,onChange:e=>setArea(e.target.value),style:{width:'100%',marginBottom:12,padding:8,borderRadius:6,border:'1px solid #ccc'},disabled:bookingStatus==='confirmed'&&autofilled}),/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:8},children:t('buycourses.date_label')}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:date,onChange:e=>setDate(e.target.value),style:{width:'100%',marginBottom:12,padding:8,borderRadius:6,border:'1px solid #ccc'},disabled:bookingStatus==='confirmed'&&autofilled}),/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:8},children:t('buycourses.start_time_label')}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:preferredStart,onChange:e=>setPreferredStart(e.target.value),style:{width:'100%',marginBottom:12,padding:8,borderRadius:6,border:'1px solid #ccc'},disabled:bookingStatus==='confirmed'&&autofilled}),/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:8},children:t('buycourses.end_time_label')}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:preferredEnd,onChange:e=>setPreferredEnd(e.target.value),style:{width:'100%',marginBottom:12,padding:8,borderRadius:6,border:'1px solid #ccc'},disabled:bookingStatus==='confirmed'&&autofilled}),/*#__PURE__*/_jsx(\"label\",{style:{display:'block',marginBottom:8},children:t('buycourses.select_course_label')}),/*#__PURE__*/_jsxs(\"select\",{value:selectedCourse?selectedCourse.name+'|'+selectedCourse.durationWeeks:'',onChange:e=>{const[name,durationWeeks]=e.target.value.split('|');setSelectedCourse(courses.find(c=>c.name===name&&String(c.durationWeeks)===durationWeeks));},style:{width:'100%',marginBottom:12,padding:8,borderRadius:6,border:'1px solid #ccc'},disabled:bookingStatus==='confirmed'&&autofilled,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:t('buycourses.select_course_option')}),courses.map((course,i)=>/*#__PURE__*/_jsxs(\"option\",{value:course.name+'|'+course.durationWeeks,children:[course.name,\" (\",t('buycourses.duration'),\": \",course.durationWeeks||'?',\")\"]},i))]}),bookingStatus==='confirmed'&&autofilled?/*#__PURE__*/_jsx(\"button\",{onClick:handleCheckout,disabled:stripeLoading,style:{width:'100%',background:'#ff6b57',color:'#fff',border:'none',borderRadius:6,padding:'10px 0',fontWeight:600},children:stripeLoading?t('buycourses.processing_payment'):t('buycourses.pay_now',{price:userPackage==='premium'?(COURSE.price*people*0.8).toFixed(2):(COURSE.price*people).toFixed(2)})}):/*#__PURE__*/_jsx(\"button\",{onClick:handleBook,disabled:stripeLoading,style:{width:'100%',background:'#90be55',color:'#fff',border:'none',borderRadius:6,padding:'10px 0',fontWeight:600,marginBottom:12},children:stripeLoading?t('buycourses.booking'):t('buycourses.book_now',{price:userPackage==='premium'?(COURSE.price*people*0.8).toFixed(2):(COURSE.price*people).toFixed(2)})}),bookingStatus==='on-hold'&&/*#__PURE__*/_jsx(\"div\",{style:{color:'#888',marginTop:12},children:t('buycourses.waiting_confirmation')}),message&&/*#__PURE__*/_jsx(\"div\",{style:{color:'green',marginTop:8},children:t('buycourses.message',{message})}),error&&/*#__PURE__*/_jsx(\"div\",{style:{color:'red',marginTop:8},children:t('buycourses.error',{error})})]})]})]})]})}),/*#__PURE__*/_jsx(Footer2,{})]});};export default BuyCourses;","map":{"version":3,"names":["React","useEffect","useState","useRef","Header","Footer2","useApi","API_BASE","API_BASE_URL","useTranslation","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","COURSE","title","description","price","image","require","id","BuyCourses","t","i18n","date","setDate","people","setPeople","checking","setChecking","available","setAvailable","error","setError","stripeLoading","setStripeLoading","city","setCity","instructors","setInstructors","selectedInstructor","setSelectedInstructor","availableSlots","setAvailableSlots","selectedSlot","setSelectedSlot","message","setMessage","userPackage","localStorage","getItem","toLowerCase","isEligible","hasCourse","preferredStart","setPreferredStart","preferredEnd","setPreferredEnd","courses","setCourses","selectedCourse","setSelectedCourse","get","post","area","setArea","bookingId","setBookingId","bookingStatus","setBookingStatus","pollingRef","autofilled","setAutofilled","confirmedBooking","setConfirmedBooking","fetch","concat","then","res","json","data","courseMap","forEach","course","normalizedName","name","trim","key","durationWeeks","Object","values","encodeURIComponent","areaMatches","filter","inst","_inst$city","_inst$location","location","cityMatches","_inst$city2","filtered","length","subjects","subj","catch","subtractBooking","slot","booking","end","start","to24Hour","timeStr","includes","time","modifier","split","hours","minutes","String","Number","padStart","Promise","all","map","email","profiles","filteredProfiles","some","day","Date","toLocaleDateString","weekday","slots","_inst$availability","avail","availability","bookings","b","free","_objectSpread","bk","flatMap","s","f","slotStart","slotEnd","push","instructor","firstName","lastName","checkAvailability","setTimeout","handleBook","userId","start24","end24","response","method","headers","body","JSON","stringify","courseName","status","current","clearInterval","setInterval","statusRes","statusData","err","handleCheckout","credentials","cart","quantity","url","setItem","window","href","find","_id","pending","paid","bookingIdLS","removeItem","savedLang","language","changeLanguage","children","style","margin","background","minHeight","padding","display","flexDirection","alignItems","width","borderRadius","boxShadow","overflow","height","justifyContent","position","src","alt","objectFit","top","left","color","fontWeight","fontSize","marginBottom","onClick","marginTop","border","textDecoration","paddingLeft","type","min","value","onChange","e","Math","max","parseInt","target","disabled","c","i","toFixed"],"sources":["/Users/mac/Desktop/data/application/EFrontend/src/BuyCourses.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport Header from './Home/Header';\nimport Footer2 from './Home/Footer2';\nimport { useApi } from './hooks/useApi';\nimport { API_BASE, API_BASE_URL } from './config';\nimport { useTranslation } from 'react-i18next';\n\nconst COURSE = {\n  title: \"Net Zero Carbon Strategy for Business\",\n  description: \"A comprehensive course on decarbonisation, carbon accounting, carbon reduction, and sustainability for businesses. Taught by industry experts. Includes video lectures, downloadable resources, and a certificate.\",\n  price: 10,\n  image: require('./Home/Logo.png'),\n  id: 'netzero-carbon-course',\n};\n\nconst BuyCourses = () => {\n  const { t, i18n } = useTranslation();\n  const [date, setDate] = useState('');\n  const [people, setPeople] = useState(8);\n  const [checking, setChecking] = useState(false);\n  const [available, setAvailable] = useState(null);\n  const [error, setError] = useState('');\n  const [stripeLoading, setStripeLoading] = useState(false);\n  const [city, setCity] = useState('');\n  const [instructors, setInstructors] = useState([]);\n  const [selectedInstructor, setSelectedInstructor] = useState('');\n  const [availableSlots, setAvailableSlots] = useState([]);\n  const [selectedSlot, setSelectedSlot] = useState(null);\n  const [message, setMessage] = useState('');\n  const userPackage = (localStorage.getItem('package') || '').toLowerCase();\n  const isEligible = userPackage === 'pro' || userPackage === 'premium';\n  const hasCourse = localStorage.getItem('hasCourse') === 'true';\n  const [preferredStart, setPreferredStart] = useState('');\n  const [preferredEnd, setPreferredEnd] = useState('');\n  const [courses, setCourses] = useState([]);\n  const [selectedCourse, setSelectedCourse] = useState(null);\n  const { get, post } = useApi();\n  const [area, setArea] = useState('');\n  const [bookingId, setBookingId] = useState(null);\n  const [bookingStatus, setBookingStatus] = useState('');\n  const pollingRef = useRef(null);\n  const [autofilled, setAutofilled] = useState(false);\n  const [confirmedBooking, setConfirmedBooking] = useState(null);\n\n  useEffect(() => {\n    // Optionally, fetch from backend if you want to check real purchase status\n  }, []);\n\n  // Fetch all courses on mount\n  useEffect(() => {\n    fetch(`${API_BASE_URL}/api/courses`)\n      .then(res => res.json())\n      .then(data => {\n        // Ensure distinct courses by normalizing names\n        const courseMap = {};\n        data.forEach(course => {\n          const normalizedName = course.name.trim().toLowerCase();\n          const key = normalizedName + '|' + course.durationWeeks;\n          if (!courseMap[key]) {\n            courseMap[key] = { \n              name: course.name.trim(),\n              durationWeeks: course.durationWeeks \n            };\n          }\n        });\n        setCourses(Object.values(courseMap));\n      });\n  }, []);\n\n  // Fetch instructors when city or area changes\n  useEffect(() => {\n    if (city) {\n      fetch(`${API_BASE_URL}/api/instructors?city=${encodeURIComponent(city)}`)\n        .then(res => res.json())\n        .then(data => {\n          // First, filter by city and area\n          const areaMatches = data.filter(inst =>\n            inst.city?.toLowerCase() === city.toLowerCase() &&\n            inst.location?.toLowerCase() === area.toLowerCase()\n          );\n          // If no area matches, show all city matches\n          const cityMatches = data.filter(inst =>\n            inst.city?.toLowerCase() === city.toLowerCase()\n          );\n          const filtered = area && areaMatches.length > 0 ? areaMatches : cityMatches;\n          setInstructors(filtered);\n\n          // Aggregate unique courses from these instructors\n          const courseMap = {};\n          filtered.forEach(inst => {\n            (inst.subjects || []).forEach(subj => {\n              // Normalize course name to handle case variations\n              const normalizedName = subj.name.trim().toLowerCase();\n              const key = normalizedName + '|' + subj.durationWeeks;\n              if (!courseMap[key]) {\n                courseMap[key] = { \n                  name: subj.name.trim(), // Keep original case for display\n                  durationWeeks: subj.durationWeeks \n                };\n              }\n            });\n          });\n          setCourses(Object.values(courseMap));\n        })\n        .catch(() => {\n          setInstructors([]);\n          setCourses([]);\n        });\n    } else {\n      setInstructors([]);\n      setCourses([]);\n    }\n    setSelectedInstructor('');\n    setAvailableSlots([]);\n    setSelectedSlot(null);\n    setSelectedCourse(null);\n  }, [city, area, date]);\n\n  // Helper to subtract a booking from a slot\n  function subtractBooking(slot, booking) {\n    // No overlap\n    if (booking.end <= slot.start || booking.start >= slot.end) return [slot];\n    // Booking covers the whole slot\n    if (booking.start <= slot.start && booking.end >= slot.end) return [];\n    // Booking overlaps at the start\n    if (booking.start <= slot.start && booking.end < slot.end) return [{ start: booking.end, end: slot.end }];\n    // Booking overlaps at the end\n    if (booking.start > slot.start && booking.end >= slot.end) return [{ start: slot.start, end: booking.start }];\n    // Booking is in the middle\n    return [\n      { start: slot.start, end: booking.start },\n      { start: booking.end, end: slot.end }\n    ];\n  }\n\n  // Helper to convert time to 24-hour format\n  function to24Hour(timeStr) {\n    if (!timeStr) return '';\n    if (timeStr.includes(':') && (timeStr.includes('AM') || timeStr.includes('PM'))) {\n      // e.g., '10:14 AM' or '01:09 PM'\n      const [time, modifier] = timeStr.split(' ');\n      let [hours, minutes] = time.split(':');\n      if (modifier === 'PM' && hours !== '12') hours = String(Number(hours) + 12);\n      if (modifier === 'AM' && hours === '12') hours = '00';\n      return `${hours.padStart(2, '0')}:${minutes}`;\n    }\n    // Already in 24-hour format\n    return timeStr;\n  }\n\n  // Fetch available slots for all instructors in city for selected date and preferred time\n  useEffect(() => {\n    if (instructors.length && date && preferredStart && preferredEnd && selectedCourse) {\n      Promise.all(instructors.map(inst =>\n        fetch(`${API_BASE_URL}/api/instructors/profile/${inst.email}`)\n          .then(res => res.json())\n      )).then(profiles => {\n        // Filter instructors who offer the selected course\n        const filteredProfiles = profiles.filter(inst =>\n          (inst.subjects || []).some(subj =>\n            subj.name.toLowerCase().trim() === selectedCourse.name.toLowerCase().trim() && \n            String(subj.durationWeeks) === String(selectedCourse.durationWeeks)\n          )\n        );\n        const day = new Date(date).toLocaleDateString('en-US', { weekday: 'long' });\n        let slots = [];\n        filteredProfiles.forEach(inst => {\n          const avail = inst.availability?.[day] || [];\n          const bookings = (inst.bookings || []).filter(b => b.date === date);\n          avail.forEach(slot => {\n            let free = [{ ...slot }];\n            bookings.forEach(bk => {\n              free = free.flatMap(s => subtractBooking(s, bk));\n            });\n            free.forEach(f => {\n              // Only show slots that overlap with preferred time\n              if (\n                f.start && f.end &&\n                f.start <= preferredEnd && f.end >= preferredStart\n              ) {\n                // Clamp slot to preferred time\n                const slotStart = f.start < preferredStart ? preferredStart : f.start;\n                const slotEnd = f.end > preferredEnd ? preferredEnd : f.end;\n                slots.push({ instructor: inst.email, start: slotStart, end: slotEnd, name: `${inst.firstName} ${inst.lastName}`, location: inst.location });\n              }\n            });\n          });\n        });\n        setAvailableSlots(slots);\n      });\n    } else {\n      setAvailableSlots([]);\n    }\n  }, [instructors, date, preferredStart, preferredEnd, selectedCourse]);\n\n  const checkAvailability = async () => {\n    setChecking(true);\n    setError('');\n    setTimeout(() => {\n      setAvailable(true);\n      setChecking(false);\n    }, 700);\n  };\n\n  const handleBook = async () => {\n    if (!selectedCourse || !date || !city || !area) {\n      setError('Please fill all fields.');\n      return;\n    }\n    setStripeLoading(true);\n    setError('');\n    setMessage('');\n    try {\n      const userId = localStorage.getItem('userId');\n      if (!userId) {\n        setError('You must be logged in to book.');\n        setStripeLoading(false);\n        return;\n      }\n      // Convert times to 24-hour format\n      const start24 = to24Hour(preferredStart);\n      const end24 = to24Hour(preferredEnd);\n      const response = await fetch(`${API_BASE_URL}/api/bookings`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          userId,\n          date,\n          city,\n          area,\n          courseName: selectedCourse.name,\n          durationWeeks: selectedCourse.durationWeeks,\n          start: start24,\n          end: end24\n        })\n      });\n      const data = await response.json();\n      if (response.status === 201) {\n        setMessage('Booking created and instructors notified. Awaiting instructor confirmation.');\n        setBookingId(data.bookingId);\n        setBookingStatus('on-hold');\n        // Start polling for status\n        if (pollingRef.current) clearInterval(pollingRef.current);\n        pollingRef.current = setInterval(async () => {\n          const statusRes = await fetch(`${API_BASE_URL}/api/bookings/${data.bookingId}/status`);\n          const statusData = await statusRes.json();\n          if (statusData.status === 'confirmed') {\n            setBookingStatus('confirmed');\n            setMessage('Booking confirmed! You can now proceed to payment.');\n            clearInterval(pollingRef.current);\n          }\n        }, 5000);\n      } else {\n        setError(data.message || 'Booking failed. Please try another date.');\n      }\n    } catch (err) {\n      setError('Booking error.');\n    }\n    setStripeLoading(false);\n  };\n\n  const handleCheckout = async () => {\n    setStripeLoading(true);\n    setError('');\n    let price = COURSE.price * people;\n    if (userPackage === 'premium') price = price * 0.8;\n    try {\n      const res = await fetch(`${API_BASE}/api/create-checkout-session`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        credentials: 'include',\n        body: JSON.stringify({\n          cart: [{ name: COURSE.title, price, quantity: 1 }]\n        })\n      });\n      const data = await res.json();\n      if (data.url) {\n        localStorage.setItem('purchasedPackage', `course:${COURSE.title}`);\n        localStorage.setItem('hasCourse', 'true');\n        if (bookingId) {\n          localStorage.setItem('bookingId', bookingId);\n        }\n        window.location.href = data.url;\n      } else {\n        setError('Failed to start checkout.');\n      }\n    } catch (err) {\n      setError('Checkout error.');\n    } finally {\n      setStripeLoading(false);\n    }\n  };\n\n  // Autofill form after booking is confirmed\n  useEffect(() => {\n    if (bookingId && bookingStatus === 'confirmed' && !autofilled) {\n      fetch(`${API_BASE_URL}/api/bookings/${bookingId}/status`)\n        .then(res => res.json())\n        .then(data => {\n          if (data && data.status === 'confirmed') {\n            // Assume booking details are available in data or fetch full booking if needed\n            fetch(`${API_BASE_URL}/api/bookings/user/${localStorage.getItem('userId')}`)\n              .then(res => res.json())\n              .then(bookings => {\n                const booking = bookings.find(b => b._id === bookingId);\n                if (booking) {\n                  setDate(booking.date);\n                  setCity(booking.city);\n                  setArea(booking.area);\n                  setSelectedCourse({ name: booking.courseName, durationWeeks: booking.durationWeeks });\n                  setAutofilled(true);\n                }\n              });\n          }\n        });\n    }\n  }, [bookingId, bookingStatus, autofilled]);\n\n  // On page load, check for pending payment booking\n  useEffect(() => {\n    const userId = localStorage.getItem('userId');\n    if (!userId) return;\n    fetch(`${API_BASE_URL}/api/bookings/user/${userId}`)\n      .then(res => res.json())\n      .then(bookings => {\n        // Find the latest booking that is confirmed but not paid\n        const pending = bookings.find(\n          b => b.status === 'confirmed' && !b.paid\n        );\n        if (pending) {\n          setBookingId(pending._id);\n          setDate(pending.date);\n          setCity(pending.city);\n          setArea(pending.area);\n          setSelectedCourse({ name: pending.courseName, durationWeeks: pending.durationWeeks });\n          setBookingStatus('confirmed');\n          setAutofilled(true);\n        } else {\n          // No pending payment, reset autofill\n          setBookingId(null);\n          setDate('');\n          setCity('');\n          setArea('');\n          setSelectedCourse(null);\n          setBookingStatus('');\n          setAutofilled(false);\n        }\n      });\n  }, []);\n\n  // After payment, clear autofill and allow new bookings\n  useEffect(() => {\n    if (autofilled && bookingStatus === 'confirmed' && hasCourse) {\n      setBookingId(null);\n      setDate('');\n      setCity('');\n      setArea('');\n      setSelectedCourse(null);\n      setBookingStatus('');\n      setAutofilled(false);\n    }\n  }, [hasCourse]);\n\n  // Show booking confirmation after payment\n  useEffect(() => {\n    const bookingIdLS = localStorage.getItem('bookingId');\n    if (hasCourse && bookingIdLS) {\n      fetch(`${API_BASE_URL}/api/bookings/${bookingIdLS}/status`)\n        .then(res => res.json())\n        .then(data => {\n          setConfirmedBooking(data);\n          localStorage.removeItem('bookingId');\n        });\n    }\n  }, [hasCourse]);\n\n  // Always reset confirmation on mount so form is shown on new visits\n  useEffect(() => {\n    setConfirmedBooking(null);\n  }, []);\n\n  // Reset form after payment is successful (booking is paid)\n  useEffect(() => {\n    if (bookingStatus === 'confirmed' && confirmedBooking && confirmedBooking.paid) {\n      setDate('');\n      setCity('');\n      setArea('');\n      setSelectedCourse(null);\n      setPeople(8);\n      setPreferredStart('');\n      setPreferredEnd('');\n      setAvailableSlots([]);\n      setSelectedSlot(null);\n      setMessage('');\n      setError('');\n      setBookingId(null);\n      setBookingStatus('');\n      setAutofilled(false);\n      setConfirmedBooking(null);\n    }\n  }, [bookingStatus, confirmedBooking]);\n\n  useEffect(() => {\n    const savedLang = localStorage.getItem('selectedLanguage');\n    if (savedLang && savedLang !== i18n.language) {\n      i18n.changeLanguage(savedLang);\n    }\n  }, [i18n]);\n\n  return (\n    <>\n      <Header />\n      <div style={{ margin:'200px',background: '#fff', minHeight: '100vh', padding: '120px 0 60px 0', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\n        <div style={{ width: 400, background: '#fff', borderRadius: 20, boxShadow: '0 4px 24px rgba(0,0,0,0.08)', overflow: 'hidden', margin: '32px 0', padding: 0 }}>\n          <div style={{ height: 180, background: '#222', display: 'flex', alignItems: 'center', justifyContent: 'center', overflow: 'hidden', position: 'relative' }}>\n            <img src={COURSE.image} alt={t('buycourses.course_image_alt')} style={{ width: '100%', height: '100%', objectFit: 'cover' }} />\n            <span style={{\n              position: 'absolute',\n              top: 16,\n              left: 16,\n              background: '#ffb400',\n              color: '#fff',\n              borderRadius: 8,\n              padding: '4px 16px',\n              fontWeight: 600,\n              fontSize: 16,\n              boxShadow: '0 2px 8px rgba(0,0,0,0.08)',\n              display: 'inline-block',\n            }}>{t('buycourses.featured')}</span>\n          </div>\n          <div style={{ padding: 28 }}>\n            <h2 style={{ fontWeight: 700, fontSize: 24, marginBottom: 8 }}>{t('buycourses.title')}</h2>\n            <div style={{ color: '#222', fontSize: 16, marginBottom: 12 }}>{t('buycourses.description')}</div>\n            <div style={{ color: '#27ae60', fontWeight: 600, fontSize: 18, marginBottom: 8 }}>\n              {t('buycourses.price', { price: COURSE.price })} {userPackage === 'premium' && <span>({t('buycourses.premium_discount')})</span>}\n            </div>\n            <div style={{ color: '#888', fontSize: 14, marginBottom: 18 }}>{t('buycourses.min_people')}</div>\n            {confirmedBooking ? (\n              <div style={{ color: 'green', fontWeight: 600, fontSize: 18, margin: '18px 0' }}>\n                <h2>{t('buycourses.booking_confirmed')}</h2>\n                {confirmedBooking.instructor && (\n                  <p>{t('buycourses.instructor')}: {confirmedBooking.instructor.firstName} {confirmedBooking.instructor.lastName} ({confirmedBooking.instructor.email})</p>\n                )}\n                <p>{t('buycourses.payment_thank_you')}</p>\n                <button onClick={() => {\n                  setConfirmedBooking(null);\n                  setDate('');\n                  setCity('');\n                  setArea('');\n                  setSelectedCourse(null);\n                  setPeople(8);\n                  setPreferredStart('');\n                  setPreferredEnd('');\n                  setAvailableSlots([]);\n                  setSelectedSlot(null);\n                  setMessage('');\n                  setError('');\n                  setBookingId(null);\n                  setBookingStatus('');\n                  setAutofilled(false);\n                }} style={{marginTop: 16, background: '#90be55', color: '#fff', border: 'none', borderRadius: 6, padding: '10px 24px', fontWeight: 600, fontSize: 16}}>\n                  {t('buycourses.book_another')}\n                </button>\n              </div>\n            ) : (\n              <>\n                {!isEligible && (\n                  <div style={{ color: '#e74c3c', fontWeight: 600, fontSize: 18, margin: '18px 0' }}>\n                    {t('buycourses.membership_required')}<br />\n                    <a href=\"/pricing\" style={{ color: '#ff6b57', textDecoration: 'underline' }}>{t('buycourses.see_membership')}</a>\n                  </div>\n                )}\n                {/* Remove this block so the form is always shown */}\n                {/* {hasCourse && (\n                  <div style={{ color: '#27ae60', fontWeight: 600, fontSize: 18, margin: '18px 0' }}>\n                    You have already purchased this course.<br />\n                    <a href=\"/courses\" style={{ color: '#ff6b57', textDecoration: 'underline' }}>Go to Courses</a>\n                  </div>\n                )} */}\n                {/* Always show the booking form. Disable fields and show Pay Now if confirmed and not paid. */}\n                <>\n                  <ol style={{ marginBottom: 16, color: '#888', fontSize: 15, paddingLeft: 18 }}>\n                    <li>{t('buycourses.step1')}</li>\n                    <li>{t('buycourses.step2')}</li>\n                    <li>{t('buycourses.step3')}</li>\n                    <li>{t('buycourses.step4')}</li>\n                  </ol>\n                  <label style={{ display: 'block', marginBottom: 8 }}>{t('buycourses.people_label')}</label>\n                  <input type=\"number\" min={8} value={people} onChange={e => setPeople(Math.max(8, parseInt(e.target.value)||8))} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled} />\n                  <label style={{ display: 'block', marginBottom: 8 }}>{t('buycourses.city_label')}</label>\n                  <input type=\"text\" value={city} onChange={e => setCity(e.target.value)} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled} />\n                  <label style={{ display: 'block', marginBottom: 8 }}>{t('buycourses.area_label')}</label>\n                  <input type=\"text\" value={area} onChange={e => setArea(e.target.value)} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled} />\n                  <label style={{ display: 'block', marginBottom: 8 }}>{t('buycourses.date_label')}</label>\n                  <input type=\"date\" value={date} onChange={e => setDate(e.target.value)} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled} />\n                  <label style={{ display: 'block', marginBottom: 8 }}>{t('buycourses.start_time_label')}</label>\n                  <input type=\"time\" value={preferredStart} onChange={e => setPreferredStart(e.target.value)} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled} />\n                  <label style={{ display: 'block', marginBottom: 8 }}>{t('buycourses.end_time_label')}</label>\n                  <input type=\"time\" value={preferredEnd} onChange={e => setPreferredEnd(e.target.value)} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled} />\n                  <label style={{ display: 'block', marginBottom: 8 }}>{t('buycourses.select_course_label')}</label>\n                  <select value={selectedCourse ? selectedCourse.name + '|' + selectedCourse.durationWeeks : ''} onChange={e => {\n                    const [name, durationWeeks] = e.target.value.split('|');\n                    setSelectedCourse(courses.find(c => c.name === name && String(c.durationWeeks) === durationWeeks));\n                  }} style={{ width: '100%', marginBottom: 12, padding: 8, borderRadius: 6, border: '1px solid #ccc' }} disabled={bookingStatus === 'confirmed' && autofilled}>\n                    <option value=\"\">{t('buycourses.select_course_option')}</option>\n                    {courses.map((course, i) => (\n                      <option key={i} value={course.name + '|' + course.durationWeeks}>\n                        {course.name} ({t('buycourses.duration')}: {course.durationWeeks || '?'})\n                      </option>\n                    ))}\n                  </select>\n                  {bookingStatus === 'confirmed' && autofilled ? (\n                    <button onClick={handleCheckout} disabled={stripeLoading} style={{ width: '100%', background: '#ff6b57', color: '#fff', border: 'none', borderRadius: 6, padding: '10px 0', fontWeight: 600 }}>\n                      {stripeLoading ? t('buycourses.processing_payment') : t('buycourses.pay_now', { price: userPackage === 'premium' ? (COURSE.price*people*0.8).toFixed(2) : (COURSE.price*people).toFixed(2) })}\n                    </button>\n                  ) : (\n                    <button onClick={handleBook} disabled={stripeLoading} style={{ width: '100%', background: '#90be55', color: '#fff', border: 'none', borderRadius: 6, padding: '10px 0', fontWeight: 600, marginBottom: 12 }}>\n                      {stripeLoading ? t('buycourses.booking') : t('buycourses.book_now', { price: userPackage === 'premium' ? (COURSE.price*people*0.8).toFixed(2) : (COURSE.price*people).toFixed(2) })}\n                    </button>\n                  )}\n\n                  {bookingStatus === 'on-hold' && (\n                    <div style={{ color: '#888', marginTop: 12 }}>{t('buycourses.waiting_confirmation')}</div>\n                  )}\n                  {message && <div style={{ color: 'green', marginTop: 8 }}>{t('buycourses.message', { message })}</div>}\n                  {error && <div style={{ color: 'red', marginTop: 8 }}>{t('buycourses.error', { error })}</div>}\n                </>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n      <Footer2 />\n    </>\n  );\n};\n\nexport default BuyCourses; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}